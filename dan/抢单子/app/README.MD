# 自动接单助手 (Windows版)

## 概述

**自动接单助手**是一款专为Windows平台设计的自动化工具，旨在帮助用户高速、自动地处理来自企业微信等平台的派单通知。本程序采用先进的图色识别技术，能够实现毫秒级的响应速度，极大提升抢单成功率。

程序拥有用户友好的图形界面（GUI），所有关键参数均可由用户自定义，并能自动保存配置，方便日常使用。

##核心功能

- **极速响应**：采用高频像素比对技术代替传统的OCR文字识别，一旦监控区域发生任何像素变化，即判定为新订单并立即响应，将检测延迟降至最低。
- **动态识别**：通过OpenCV模板匹配技术，在指定区域内动态搜索“接单”按钮，解决了因界面布局变化导致按钮位置不固定的问题。
- **高度可配置**：用户可通过GUI界面轻松设置所有关键坐标和延时参数，包括：
  - 新单监控区域
  - “接单”按钮的搜索区域
  - “确认”和“关闭”按钮的精确坐标
  - 各个操作步骤之间的延时
- **智能流程控制**：能够自动处理“已被他人接单”的场景，在找不到“接单”按钮时会自动关闭详情页，返回继续监控，保证7x24小时稳定运行。
- **实时日志**：所有操作流程、成功信息、错误警告和耗时报告都会实时显示在主界面的日志窗口中，方便用户监控程序状态。
- **配置持久化**：所有设置项在保存后会自动记录在用户目录下的配置文件中，下次启动程序时无需重新配置。

## 安装与环境准备

在运行本程序前，请确保您的Windows系统已完成以下环境配置。

### 1. 安装 Tesseract OCR 引擎

本程序使用Tesseract进行底层图像处理支持。

1.  **下载安装包**：访问 [Tesseract at UB Mannheim](https://github.com/UB-Mannheim/tesseract/wiki) 下载最新的64位安装程序 (`tesseract-ocr-w64-setup-vX.X.X.exe`)。
2.  **安装**：运行安装程序。在“选择组件”步骤时，**必须展开 `Additional language data`**，并勾选 **`Chinese, Simplified` (简体中文)**。建议使用默认安装路径 `C:\Program Files\Tesseract-OCR`。

### 2. 安装 Python 依赖库 (仅适用于源码运行)

如果您需要从Python源码运行，请先安装所有必需的库。打开命令提示符(CMD)并运行：

```bash
pip install pyautogui pillow pytesseract opencv-python numpy mss
```

## 使用说明

1.  **准备模板文件**：
    -   截取一张清晰、无边框的“接单”按钮图片，并将其命名为 `accept_button_template.png`。
    -   准备一个 `.ico` 格式的图标文件，并将其命名为 `app.ico` (打包时使用)。
    -   将这两个文件与主程序 `.exe` 或 `.py` 文件放在同一个文件夹下。

2.  **运行程序**：
    -   双击 `自动接单助手.exe` 启动程序。

3.  **配置参数**：
    -   **开启坐标显示**：点击此按钮，程序会实时显示当前鼠标的屏幕坐标。
    -   **设置监控区**：将鼠标移动到新订单通知区域的左上角和右下角，记下坐标并填入。
    -   **设置接单按钮搜索区**：在工单详情页，框选一个足够大、能保证“接单”按钮总会出现在里面的区域，填入其左上角和右下角坐标。
    -   **设置确认/关闭按钮坐标**：将鼠标移动到“确认”和“关闭”按钮的中心，记下坐标并填入。
    -   **调整延时**：根据网络和电脑性能，适当调整各个步骤的延时，以确保流程稳定。

4.  **保存与运行**：
    -   点击 **“保存配置”** 按钮，您的设置将被永久保存。
    -   点击 **“开始运行”** 按钮，程序将最小化到任务栏并开始自动化监控。
    -   点击 **“停止运行”** 或任务栏图标可恢复窗口并停止任务。

## 打包为 EXE (开发者)

如果您修改了源码，可以使用 PyInstaller 将其重新打包为单个可执行文件。

1.  **安装 PyInstaller**:
    ```bash
    pip install pyinstaller
    ```
2.  **准备文件**：将 `auto_order_accepter_windows.py`, `accept_button_template.png`, 和 `app.ico` 放在同一个目录下。

3.  **执行打包命令**：打开CMD，进入该目录，并运行以下命令：
    ```bash
    pyinstaller --name "自动接单助手" --onefile --windowed --icon="app.ico" --add-data "C:/Program Files/Tesseract-OCR/tessdata;tessdata" --add-data "accept_button_template.png;." auto_order_accepter_windows.py
    ```
4.  **查找成品**：打包成功后，可在生成的 `dist` 文件夹内找到 `自动接单助手.exe`。

## 注意事项

- **管理员权限**：在某些情况下，如果程序无法模拟鼠标点击，请尝试以管理员身份运行本程序。
- **杀毒软件**：自行打包的程序可能会被杀毒软件误报，请选择信任或允许运行。
- **模板图片质量**：`accept_button_template.png` 的清晰度直接影响识别成功率，请确保截图质量。